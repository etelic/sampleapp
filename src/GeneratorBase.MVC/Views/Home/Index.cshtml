@using Microsoft.AspNet.Identity
@{
    ViewBag.Title = "Home";
}
<script>
    function HomeSearchClick(e, EntityName, url) {
        var txtval = $("#SearchString" + EntityName).val();
        url = url + "?searchString=" + txtval + "&IsDeepSearch=true&parent=Home";
        window.location.href = url;
    }
    function SearchKeyPress(e, entityName) {
        if ((e.which && e.which == 13) || (e.keyCode && e.keyCode == 13)) {
            $("#" + entityName + "Search").bind("click", (function () {
            }));
            $("#" + entityName + "Search").trigger("click");
        }
    }
</script>
@if (ViewBag.PageRoles != null && ViewBag.PageContent == null)
{
      <script type="text/javascript">
        $(document).ready(function () {
            $('#myModal').modal('show');
        });
		function getrole() {
            var selctedvalues = "";
            $("input[name='rdbroles']").each(function () {
                chkid = $(this).attr('id');
                var checked = "false";
                if ($("input[id='" + chkid + "']:checked").length == '1') {
                    selctedvalues += $(this).attr('value') + ",";
                }
            })
            if (selctedvalues != '' && typeof selctedvalues != 'undefined') {
                var data = { "key": selctedvalues };
                var urlSet = '@Url.Action("setRoleValue", "Home")';
                var url = '@Url.Action("Index", "Home")';
                $.getJSON(urlSet, data, function (data) {
                    if (data == true) {
                        window.location.href = url;
                    }
                });
            }
            else {
                alert('Please select at lease one role.')
            }
        }
    </script>
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body">
                    <div class="panel panel-default">
                        <div class="panel-heading clearfix" style="margin:0px; padding:8px;">
                            Please select roles to login with
                        </div>
                        <div class="panel-body" style="margin:0px; padding:8px;">
                            @foreach (string pagerole in ViewBag.PageRoles)
                            {
								<div style="display:block;">
								<label for="@pagerole" class="check">
                                    <input type="checkbox" id="@pagerole" name="rdbroles" value="@pagerole" /> @pagerole
                                </label>
								 </div>
                            }
                        </div>
                    </div>
                    <a onclick="getrole();" class="btn btn-primary btn-sm">Login</a>
                    <a href="javascript:document.getElementById('logoutForm').submit()" class="btn btn-default btn-sm" > Logout</a>
                </div>
            </div>
        </div>
    </div>
}
@if (ViewBag.RegistrationEntity != null)
{
    var AutoRegistration = Convert.ToString(ViewBag.RegistrationEntity).Split(",".ToCharArray());
    <script type="text/javascript">
        $(document).ready(function () {
            $('#RegistrationModal').modal('show');
        });
    </script>
    <div class="modal fade" id="RegistrationModal" tabindex="-1" role="dialog" aria-labelledby="RegistrationModalLabel" aria-hidden="true" data-keyboard="false" data-backdrop="static">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-body">
                    <div class="panel panel-default">
                        <div class="panel-heading clearfix" style="margin:0px; padding:8px;">
                           <span class="fam-application-form-edit"></span> Click to Register as
                        </div>
                        <div class="panel-body" style="margin:0px; padding:8px;">
                            <div style="display:block;">
                                @foreach (string reg in AutoRegistration)
                                {
                                    var Ent = ModelReflector.Entities.FirstOrDefault(p => p.Name == reg);
                                    if (Ent != null)
                                    {
                                        @Html.ActionLink(Ent.DisplayName, "AutoRegistration", reg, new { UserId = ViewBag.UserId }, new { @class = "btn btn-default btn-sm", @style="margin-right:5px;"})
                                    }
                                }
                            </div>
                        </div>
                    </div>
                    <br />
                    @Html.ActionLink("Continue without Registration", "Index", "Home", null, new { @class = "btn btn-default btn-sm" })
                    <a href="javascript:document.getElementById('logoutForm').submit()" class="btn btn-primary btn-sm pull-right"> Logout</a>
                </div>
            </div>
        </div>
    </div>
}
@if (ViewBag.PageRoles == null && ViewBag.PageContent == null && ViewBag.RegistrationEntity == null)
{
<script language="javascript" type="text/javascript" src="~/Content/chart/jquery.flot.js"></script>
<script language="javascript" type="text/javascript" src="~/Content/chart/jquery.flot.categories.js"></script>
<script language="javascript" type="text/javascript" src="~/Content/chart/jquery.flot.time.js"></script>
<script language="javascript" type="text/javascript" src="~/Content/chart/jquery.flot.pie.js"></script>
<script src="@Url.Content("~/Scripts/jquery.signalR-2.1.2.min.js")" type="text/javascript"></script>
<script src="@Url.Content("~/Scripts/jquery.signalR-2.1.2.min.js")"></script>
<script src="@Url.Content("~/signalr/hubs")"></script>

<script>
    
    var totalPoints =100;
		var updateIntervalT_School = 1000;
		var nowT_School =  (new Date().getTime())-100000;
		var dataT_School = [];
		var countvalueT_School = @ViewBag.T_SchoolCount;
		var yaxiscountT_School = countvalueT_School+100;
		dataT_School.push(nowT_School, @ViewBag.T_SchoolCount);
		function GetDataT_School() {
			dataT_School.shift(); //to remove first item of array
			while (dataT_School.length < totalPoints) {
				var y = countvalueT_School;
				var tempT_School = [nowT_School += updateIntervalT_School, y]; //data format [x, y]
				dataT_School.push(tempT_School);
			}
		}
		    gridStyleT_School = { borderColor: '#ddd', borderWidth: 1, hoverable: true, clickable: true };
			var optionsT_School = {
				grid: gridStyleT_School,
				legend:{show:false},
				series: { shadowSize: 0, lines: { show: true, fill: true, fillColor: 'rgba(200,220,200,.6)' }, color: '#99bb99' },
				yaxis: { min: 0, max: yaxiscountT_School, font: '#ddd' },
				xaxis: {
					mode: "time",
					tickSize: [2, "second"],
					tickFormatter: function (v, axis) {
						var date = new Date(v);
						if (date.getSeconds() % 20 == 0) {
							var hours = date.getHours() < 10 ? "0" + date.getHours() : date.getHours();
							var minutes = date.getMinutes() < 10 ? "0" + date.getMinutes() : date.getMinutes();
							var seconds = date.getSeconds() < 10 ? "0" + date.getSeconds() : date.getSeconds();
							return hours + ":" + minutes + ":" + seconds;
						} else {
							return "";
						}
					}
				}
			};
			$(document).ready(function () {
				GetDataT_School();
				datasetT_School = [
					{ label: "School Count", data: dataT_School, color: "#99BB99" }
				];
				$.plot($("#flot-placeholderT_School"), datasetT_School, optionsT_School);
				updateT_School();
			});
			function updateT_School() {
				GetDataT_School();
				$.plot($("#flot-placeholderT_School"), datasetT_School, optionsT_School)
				setTimeout(updateT_School, updateIntervalT_School);
			}
</script>
<script>
$(document).ready(function () {
var datevalue = $("#lastlogin").html();
if(datevalue != undefined && datevalue.length > 0)
{
	var date = new Date(datevalue+' UTC');
	$("#lastlogin").html(date.toLocaleString());
} else $("#lastlogin").html("You logged in first time.");
$("a:first",$("#graph")).click();
});
</script>
<div class="row">
    <div class="col-lg-12">
        <h1 class="page-title">
            <i class="glyphicon glyphicon-home text-primary" style="margin-bottom:-20px;"></i> Home <i class="glyphicon glyphicon-chevron-right small"></i>  <span>Dashboard</span>
        </h1>
    </div>
    <!-- /.col-lg-12 -->
</div>
<div class="row">
        <div class="clearfix"></div>
        <div class="col-sm-12">
		<ul class="nav nav-tabs">
<li class="active"><a href="#systeminfo" data-toggle="tab">User Info</a></li>
                <li class=""><a href="#livemoniter" data-toggle="tab">Live Data Monitering</a></li>
                <li class=""><a href="#graph" data-toggle="tab">Graph</a></li>
               
                <li><a href="#about" data-toggle="tab">About Company</a></li>
            </ul>
             <div class="tab-content" style="border-bottom: 0px solid #ddd;">
 <div class="tab-pane fade in" id="livemoniter">
		@if (User.CanView("DataMonitoring"))
		{
                <div class="panel panel-default " style="border-radius:0px 0px 4px 4px;">
                    <div class="panel-heading" style="background-color:#fff!important; ">School Count</div>
                    <div class="panel-body">
                        <div id="flot-placeholderT_School" class="big-chart"></div>
                    </div>
                </div>
		}
  </div>
	<div class="tab-pane fade in" id="graph">
        <div class="panel panel-default " style="border-radius:0px 0px 4px 4px;">
            <div class="panel-body" style="min-height:240px;">
 @if (User.Identity.IsAuthenticated && User != null && User.CanView("T_Student"))
 {
				<a class="label label-primary" style="margin-right:5px;" dataurl="@Url.Action("ShowGraph", "T_Student")" onclick="OpenDashBoardFromHome(this,'EntityGraph','Student');">
                                       Student
				</a> 
}
			<div class="panel panel-default" style="margin:10px 0px 0px 0px;">
                                <div class="panel-heading clearfix" style="padding:8px;">
                                    <h4 class="panel-title" style="display:block; " id="EntityGraphLabel"></h4>
                                </div>
                                <div class="panel-body" style="padding:0px 0px 0px 0px; border:0px;">
                                    <div id="EntityGraph">
                                    </div>
                                </div>
            </div>
            </div>
			
        </div>
    </div>
  
	 <div class="tab-pane active" id="systeminfo">
                     <div class="panel panel-default " style="border-radius:0px 0px 4px 4px;">
                        <div class="panel-body" >

                           
                                <div class="row">
                                    <div class="col-md-4 col-sm-4" style="padding:4px 10px;">
                                        <div class="dashboard-block" style="height:165px;">
                                            <div class="rotate">
                                                <i class="fa fa-user"></i>
                                            </div>
                                            <div class="details">
                                                <span class="title">User Information </span>
                                                <span class="sub text-info">@User.Name</span><small>@ViewBag.UserName </small><br /> <small>@ViewBag.Useremail</small>
												 <br/><small> Role : @String.Join(",", ViewBag.LoginRoles)</small>
                                            </div><!--/details-->

                                        </div>
                                    </div>
                                    <div class="col-md-4 col-sm-4" style="padding:4px 10px;">
                                        <div class="dashboard-block" style="height:165px;">
                                            <div class="rotate">
                                               <i class="fa fa-sign-in"></i>
                                            </div>
                                            <div class="details">
                                                <span class="title">Last Logged-In</span>
                                                <span id="lastlogin" class="sub text-danger">@ViewBag.LastLoggedIn</span>
                                            </div><!--/details-->

                                        </div>
                                    </div>
                                   

                                        <div class="col-md-4 col-sm-4" style="padding:4px 10px;">
                                            <div class="dashboard-block" style="height:165px;">
                                                <div class="rotate">
                                                    <i class="fa fa-star"></i>
                                                </div>
                                                <div class="details">
                                                    <span class="title"> Favorite Items <span class="badge bg-grey">@ViewBag.FavoriteCount</span></span>
                                                    <table class="table" style="overflow-y:auto">
                                                        <thead>
														 @if (ViewBag.FavoriteItem != null)
														 {
                                                            foreach (GeneratorBase.MVC.Models.FavoriteItem fItem in ViewBag.FavoriteItem)
                                                            {
                                                                <tr>
                                                                    <td width="90%">
                                                                        <a href='/@GeneratorBase.MVC.Models.CommonFunction.Instance.AppURL().ToString()@fItem.LinkAddress' style="color:black">@fItem.Name</a>
                                                                    </td>
                                                                    <td width="10%">
                                                                        <a href="@Url.Action("FavoriteDelete", "Home", new { id = fItem.Id })"><span class="fam-cross"></span></a>
                                                                    </td>
                                                                </tr>
                                                            }
														  }
                                                        </thead>
                                                    </table>
                                                </div><!--/details-->
                                            </div>
                                        </div>
                                </div><!--/row-->
                        </div>
                    </div>
	</div>
    <div class="tab-pane fade" id="about">
        <div class="panel panel-default " style="border-radius:0px 0px 4px 4px;">
            <div class="panel-body" style="min-height:240px;">
                @if (ViewBag.AboutCompany != null)
				{
					@Html.Raw(ViewBag.AboutCompany)
				}
            </div>
        </div>
    </div> 
	</div>  
   <div style="clear:both"></div>
          @if (User.Identity.IsAuthenticated && User != null && User.CanView("T_School"))
			{  
			 <div class="well index-box">
                <a href="@Url.Action("RedirectToEntity","Home", new { EntityName="T_School"})">
                    <h4 class="text-info"><span class="label label-info pull-right">@ViewBag.T_SchoolCount</span> School </h4>
                </a>
                <div class="input-group" style="margin-top:10px;">
                    @Html.TextBox("SearchStringT_SchoolC", ViewBag.CurrentFilter as string, null, new { @class = "form-control fixsearchbox", @onkeypress = "SearchKeyPress(event,'T_SchoolC');", @placeholder = "Search" })
                    <div class="input-group-btn">
                        <a id="T_SchoolCSearch" onclick="HomeSearchClick(event,'T_SchoolC','@Html.Raw(Url.Action("Index", "T_School"))');"
                            data-original-title="List Search"
                            class="btn btn-default btn-default tip-top"
                            style="padding:3px 5px;"><span class="glyphicon glyphicon-search"></span></a>
                    </div>
                </div>
                <div class="col-lg-12 col-sm-12" style="padding:0px; margin:5px 0px 0px 0px;">
                    <a href="@Url.Action("RedirectToEntity","Home", new { EntityName="T_School"})" class="btn btn-default btn-xs" style="width:48%">View</a>
                    @if (User.Identity.IsAuthenticated && User != null && User.CanAdd("T_School"))
                    {
                        <a onclick=@Html.Raw("NavigateToUrl('" + Url.Action("Create", "T_School", new { UrlReferrer = Request.Url, AssociatedType = ViewData["AssociatedType"], HostingEntityName = @Convert.ToString(ViewData["HostingEntity"]), HostingEntityID = @Convert.ToString(ViewData["HostingEntityID"]) }, null) + "');") style="width:48%" class="btn btn-default btn-xs"> Add </a>
                    }
                </div>
            </div>
		}
          @if (User.Identity.IsAuthenticated && User != null && User.CanView("T_Student"))
			{  
			 <div class="well index-box">
                <a href="@Url.Action("RedirectToEntity","Home", new { EntityName="T_Student"})">
                    <h4 class="text-success"><span class="label label-success pull-right">@ViewBag.T_StudentCount</span> Student </h4>
                </a>
                <div class="input-group" style="margin-top:10px;">
                    @Html.TextBox("SearchStringT_StudentC", ViewBag.CurrentFilter as string, null, new { @class = "form-control fixsearchbox", @onkeypress = "SearchKeyPress(event,'T_StudentC');", @placeholder = "Search" })
                    <div class="input-group-btn">
                        <a id="T_StudentCSearch" onclick="HomeSearchClick(event,'T_StudentC','@Html.Raw(Url.Action("Index", "T_Student"))');"
                            data-original-title="List Search"
                            class="btn btn-default btn-default tip-top"
                            style="padding:3px 5px;"><span class="glyphicon glyphicon-search"></span></a>
                    </div>
                </div>
                <div class="col-lg-12 col-sm-12" style="padding:0px; margin:5px 0px 0px 0px;">
                    <a href="@Url.Action("RedirectToEntity","Home", new { EntityName="T_Student"})" class="btn btn-default btn-xs" style="width:48%">View</a>
                    @if (User.Identity.IsAuthenticated && User != null && User.CanAdd("T_Student"))
                    {
                        <a onclick=@Html.Raw("NavigateToUrl('" + Url.Action("Create", "T_Student", new { UrlReferrer = Request.Url, AssociatedType = ViewData["AssociatedType"], HostingEntityName = @Convert.ToString(ViewData["HostingEntity"]), HostingEntityID = @Convert.ToString(ViewData["HostingEntityID"]) }, null) + "');") style="width:48%" class="btn btn-default btn-xs"> Add </a>
                    }
                </div>
            </div>
		}
          @if (User.Identity.IsAuthenticated && User != null && User.CanView("T_Department"))
			{  
			 <div class="well index-box">
                <a href="@Url.Action("RedirectToEntity","Home", new { EntityName="T_Department"})">
                    <h4 class="text-warning"><span class="label label-warning pull-right">@ViewBag.T_DepartmentCount</span> Department </h4>
                </a>
                <div class="input-group" style="margin-top:10px;">
                    @Html.TextBox("SearchStringT_DepartmentC", ViewBag.CurrentFilter as string, null, new { @class = "form-control fixsearchbox", @onkeypress = "SearchKeyPress(event,'T_DepartmentC');", @placeholder = "Search" })
                    <div class="input-group-btn">
                        <a id="T_DepartmentCSearch" onclick="HomeSearchClick(event,'T_DepartmentC','@Html.Raw(Url.Action("Index", "T_Department"))');"
                            data-original-title="List Search"
                            class="btn btn-default btn-default tip-top"
                            style="padding:3px 5px;"><span class="glyphicon glyphicon-search"></span></a>
                    </div>
                </div>
                <div class="col-lg-12 col-sm-12" style="padding:0px; margin:5px 0px 0px 0px;">
                    <a href="@Url.Action("RedirectToEntity","Home", new { EntityName="T_Department"})" class="btn btn-default btn-xs" style="width:48%">View</a>
                    @if (User.Identity.IsAuthenticated && User != null && User.CanAdd("T_Department"))
                    {
                        <a onclick=@Html.Raw("NavigateToUrl('" + Url.Action("Create", "T_Department", new { UrlReferrer = Request.Url, AssociatedType = ViewData["AssociatedType"], HostingEntityName = @Convert.ToString(ViewData["HostingEntity"]), HostingEntityID = @Convert.ToString(ViewData["HostingEntityID"]) }, null) + "');") style="width:48%" class="btn btn-default btn-xs"> Add </a>
                    }
                </div>
            </div>
		}
		@if (User.CanView("DataMonitoring"))
		{
		<div class="well index-box">
                <a href="@Url.Action("LiveMonitoring")">
                    <h4 class="text-danger"> Live Data Monitoring </h4>
                </a>
		</div>		
		}
	 
		      <div class="panel panel-default">
                    <div class="panel-heading">
                        <h4 class="panel-title" style="display:block; float:none;">
                            <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#AllEntities">
                                <span class="glyphicon glyphicon-chevron-down"></span>  All Entities
                            </a>
                        </h4>
                    </div>
                    <div id="AllEntities" class="panel-collapse collapse">
                        <div class="panel-body">
                            <div id="Des_Table" class="table-responsive">
                                <table class="table table-bordered table-hover table-condensed">
                                    <thead>
                                        <tr>
                                            <th class="col1" style="width:70px;">Actions</th>
                                            <th style="width:30%;">Entity Name</th>
                                            <th style="width:30%;">Entity Description</th>
                                            <th>Search</th>
                                        </tr>
                                    </thead>
				@if (User.CanView("T_Department"))
				{
					<tr>
						<td>
							  <div style="width:60px; margin-top:-2px;">
                                                    <center>
                                                        <div class="btn-group">
											<a class="btn btn-default btn-xs" href="@Url.Action("RedirectToEntity", "Home", new { EntityName = "T_Department" })"><i class="glyphicon glyphicon-eye-open"></i></a>
                                        @if (User.Identity.IsAuthenticated && User != null && User.CanAdd("T_Department"))
                                        {
											<a class="btn btn-default btn-xs" onclick=@Html.Raw("NavigateToUrl('" + Url.Action("Create", "T_Department", new { UrlReferrer = Request.Url, AssociatedType = ViewData["AssociatedType"], HostingEntityName = @Convert.ToString(ViewData["HostingEntity"]), HostingEntityID = @Convert.ToString(ViewData["HostingEntityID"]) }, null) + "');")><i class="glyphicon glyphicon-plus"></i></a>
                                        }                        
                                      </div>
                                                    </center>
                                                </div>
                                            </td>
                                            <td><a href="@Url.Action("RedirectToEntity", "Home", new { EntityName = "T_Department" })">Department</a></td>
                                            <td>Department</td>
                                            <td>
                                                <div class="input-group">
                                                     @Html.TextBox("SearchStringT_DepartmentA", ViewBag.CurrentFilter as string, null, new { @class = "form-control fixsearchbox", @onkeypress = "SearchKeyPress(event,'T_DepartmentA');", @placeholder = "Search" })
                                <div class="input-group-btn">
                                    <a id="T_DepartmentASearch" onclick="HomeSearchClick(event,'T_DepartmentA','@Html.Raw(Url.Action("Index", "T_Department"))');"
                                       data-original-title="List Search"
                                       class="btn btn-default btn-default tip-top"
                                       style="padding:3px 5px;"><span class="glyphicon glyphicon-search"></span></a>
                                </div>
                                                </div>
                                            </td>
                                        </tr>
				}
				@if (User.CanView("T_School"))
				{
					<tr>
						<td>
							  <div style="width:60px; margin-top:-2px;">
                                                    <center>
                                                        <div class="btn-group">
											<a class="btn btn-default btn-xs" href="@Url.Action("RedirectToEntity", "Home", new { EntityName = "T_School" })"><i class="glyphicon glyphicon-eye-open"></i></a>
                                        @if (User.Identity.IsAuthenticated && User != null && User.CanAdd("T_School"))
                                        {
											<a class="btn btn-default btn-xs" onclick=@Html.Raw("NavigateToUrl('" + Url.Action("Create", "T_School", new { UrlReferrer = Request.Url, AssociatedType = ViewData["AssociatedType"], HostingEntityName = @Convert.ToString(ViewData["HostingEntity"]), HostingEntityID = @Convert.ToString(ViewData["HostingEntityID"]) }, null) + "');")><i class="glyphicon glyphicon-plus"></i></a>
                                        }                        
                                      </div>
                                                    </center>
                                                </div>
                                            </td>
                                            <td><a href="@Url.Action("RedirectToEntity", "Home", new { EntityName = "T_School" })">School</a></td>
                                            <td>School</td>
                                            <td>
                                                <div class="input-group">
                                                     @Html.TextBox("SearchStringT_SchoolA", ViewBag.CurrentFilter as string, null, new { @class = "form-control fixsearchbox", @onkeypress = "SearchKeyPress(event,'T_SchoolA');", @placeholder = "Search" })
                                <div class="input-group-btn">
                                    <a id="T_SchoolASearch" onclick="HomeSearchClick(event,'T_SchoolA','@Html.Raw(Url.Action("Index", "T_School"))');"
                                       data-original-title="List Search"
                                       class="btn btn-default btn-default tip-top"
                                       style="padding:3px 5px;"><span class="glyphicon glyphicon-search"></span></a>
                                </div>
                                                </div>
                                            </td>
                                        </tr>
				}
				@if (User.CanView("T_Student"))
				{
					<tr>
						<td>
							  <div style="width:60px; margin-top:-2px;">
                                                    <center>
                                                        <div class="btn-group">
											<a class="btn btn-default btn-xs" href="@Url.Action("RedirectToEntity", "Home", new { EntityName = "T_Student" })"><i class="glyphicon glyphicon-eye-open"></i></a>
                                        @if (User.Identity.IsAuthenticated && User != null && User.CanAdd("T_Student"))
                                        {
											<a class="btn btn-default btn-xs" onclick=@Html.Raw("NavigateToUrl('" + Url.Action("Create", "T_Student", new { UrlReferrer = Request.Url, AssociatedType = ViewData["AssociatedType"], HostingEntityName = @Convert.ToString(ViewData["HostingEntity"]), HostingEntityID = @Convert.ToString(ViewData["HostingEntityID"]) }, null) + "');")><i class="glyphicon glyphicon-plus"></i></a>
                                        }                        
                                      </div>
                                                    </center>
                                                </div>
                                            </td>
                                            <td><a href="@Url.Action("RedirectToEntity", "Home", new { EntityName = "T_Student" })">Student</a></td>
                                            <td>Student</td>
                                            <td>
                                                <div class="input-group">
                                                     @Html.TextBox("SearchStringT_StudentA", ViewBag.CurrentFilter as string, null, new { @class = "form-control fixsearchbox", @onkeypress = "SearchKeyPress(event,'T_StudentA');", @placeholder = "Search" })
                                <div class="input-group-btn">
                                    <a id="T_StudentASearch" onclick="HomeSearchClick(event,'T_StudentA','@Html.Raw(Url.Action("Index", "T_Student"))');"
                                       data-original-title="List Search"
                                       class="btn btn-default btn-default tip-top"
                                       style="padding:3px 5px;"><span class="glyphicon glyphicon-search"></span></a>
                                </div>
                                                </div>
                                            </td>
                                        </tr>
				}
				@if (User.CanView("T_StudentPerformance"))
				{
					<tr>
						<td>
							  <div style="width:60px; margin-top:-2px;">
                                                    <center>
                                                        <div class="btn-group">
											<a class="btn btn-default btn-xs" href="@Url.Action("RedirectToEntity", "Home", new { EntityName = "T_StudentPerformance" })"><i class="glyphicon glyphicon-eye-open"></i></a>
                                        @if (User.Identity.IsAuthenticated && User != null && User.CanAdd("T_StudentPerformance"))
                                        {
											<a class="btn btn-default btn-xs" onclick=@Html.Raw("NavigateToUrl('" + Url.Action("Create", "T_StudentPerformance", new { UrlReferrer = Request.Url, AssociatedType = ViewData["AssociatedType"], HostingEntityName = @Convert.ToString(ViewData["HostingEntity"]), HostingEntityID = @Convert.ToString(ViewData["HostingEntityID"]) }, null) + "');")><i class="glyphicon glyphicon-plus"></i></a>
                                        }                        
                                      </div>
                                                    </center>
                                                </div>
                                            </td>
                                            <td><a href="@Url.Action("RedirectToEntity", "Home", new { EntityName = "T_StudentPerformance" })">StudentPerformance</a></td>
                                            <td>Student Performance</td>
                                            <td>
                                                <div class="input-group">
                                                     @Html.TextBox("SearchStringT_StudentPerformanceA", ViewBag.CurrentFilter as string, null, new { @class = "form-control fixsearchbox", @onkeypress = "SearchKeyPress(event,'T_StudentPerformanceA');", @placeholder = "Search" })
                                <div class="input-group-btn">
                                    <a id="T_StudentPerformanceASearch" onclick="HomeSearchClick(event,'T_StudentPerformanceA','@Html.Raw(Url.Action("Index", "T_StudentPerformance"))');"
                                       data-original-title="List Search"
                                       class="btn btn-default btn-default tip-top"
                                       style="padding:3px 5px;"><span class="glyphicon glyphicon-search"></span></a>
                                </div>
                                                </div>
                                            </td>
                                        </tr>
				}
					@if (User.CanView("ApplicationFeedback"))
                    {
						<tr>
						<td>
							<div style="width:60px; margin-top:-2px;">
                                                    <center>
                                                        <div class="btn-group">
											<a class="btn btn-default btn-xs" href="@Url.Action("RedirectToEntity", "Home", new { EntityName = "ApplicationFeedback" })" class="btn btn-default btn-xs"><i class="glyphicon glyphicon-eye-open"></i></a>
                                        @if (User.Identity.IsAuthenticated && User != null && User.CanAdd("ApplicationFeedback"))
                                        {
												<a class="btn btn-default btn-xs" onclick=@Html.Raw("NavigateToUrl('" + Url.Action("Create", "ApplicationFeedback", new { UrlReferrer = Request.Url, AssociatedType = ViewData["AssociatedType"], HostingEntityName = @Convert.ToString(ViewData["HostingEntity"]), HostingEntityID = @Convert.ToString(ViewData["HostingEntityID"]) }, null) + "');") class="btn btn-default btn-xs"><i class="glyphicon glyphicon-plus"></i></a>
                                        }                        
                                       </div>
                                                    </center>
                                                </div>
                                            </td>
                                            <td><a href="@Url.Action("RedirectToEntity", "Home", new { EntityName = "ApplicationFeedback" })">Application Feedback</a></td>
                                            <td>Application Feedback</td>
                                            <td>
                                                <div class="input-group">
                                                     @Html.TextBox("SearchStringApplicationFeedback", ViewBag.CurrentFilter as string, null, new { @class = "form-control fixsearchbox", @onkeypress = "SearchKeyPress(event,'ApplicationFeedback');", @placeholder = "Search" })
                                <div class="input-group-btn">
                                    <a id="ApplicationFeedbackSearch" onclick="HomeSearchClick(event,'ApplicationFeedback','@Html.Raw(Url.Action("Index", "ApplicationFeedback"))');"
                                       data-original-title="List Search"
                                       class="btn btn-default btn-default tip-top"
                                       style="padding:3px 5px;"><span class="glyphicon glyphicon-search"></span></a>
                                </div>
                                                </div>
                                            </td>
                                        </tr>
                    }
					@if (User.CanView("ApplicationFeedbackStatus"))
                    {
                        <tr>
						<td>
							<div style="width:60px; margin-top:-2px;">
                                                    <center>
                                                        <div class="btn-group">
											<a class="btn btn-default btn-xs" href="@Url.Action("RedirectToEntity", "Home", new { EntityName = "ApplicationFeedbackStatus" })"><i class="glyphicon glyphicon-eye-open"></i></a>
                                        @if (User.Identity.IsAuthenticated && User != null && User.CanAdd("ApplicationFeedbackStatus"))
                                        {
												<a class="btn btn-default btn-xs" onclick=@Html.Raw("NavigateToUrl('" + Url.Action("Create", "ApplicationFeedbackStatus", new { UrlReferrer = Request.Url, AssociatedType = ViewData["AssociatedType"], HostingEntityName = @Convert.ToString(ViewData["HostingEntity"]), HostingEntityID = @Convert.ToString(ViewData["HostingEntityID"]) }, null) + "');")><i class="glyphicon glyphicon-plus"></i></a>
                                        }                        
                                      </div>
                                                    </center>
                                                </div>
                                            </td>
                                            <td><a href="@Url.Action("RedirectToEntity", "Home", new { EntityName = "ApplicationFeedbackStatus" })">Application Feedback Status</a></td>
                                            <td>Application Feedback Status</td>
                                            <td>
                                                <div class="input-group">
                                                     @Html.TextBox("SearchStringApplicationFeedbackStatus", ViewBag.CurrentFilter as string, null, new { @class = "form-control fixsearchbox", @onkeypress = "SearchKeyPress(event,'ApplicationFeedbackStatus');", @placeholder = "Search" })
                                <div class="input-group-btn">
                                    <a id="ApplicationFeedbackStatusSearch" onclick="HomeSearchClick(event,'ApplicationFeedbackStatus','@Html.Raw(Url.Action("Index", "ApplicationFeedbackStatus"))');"
                                       data-original-title="List Search"
                                       class="btn btn-default btn-default tip-top"
                                       style="padding:3px 5px;"><span class="glyphicon glyphicon-search"></span></a>
                                </div>
                                                </div>
                                            </td>
                                        </tr>
                    }
                    @if (User.CanView("ApplicationFeedbackType"))
                    {
                        <tr>
						<td>
							<div style="width:60px; margin-top:-2px;">
                                                    <center>
                                                        <div class="btn-group">
											<a class="btn btn-default btn-xs" href="@Url.Action("RedirectToEntity", "Home", new { EntityName = "ApplicationFeedbackType" })"><i class="glyphicon glyphicon-eye-open"></i></a>
                                        @if (User.Identity.IsAuthenticated && User != null && User.CanAdd("ApplicationFeedbackType"))
                                        {
												<a class="btn btn-default btn-xs" onclick=@Html.Raw("NavigateToUrl('" + Url.Action("Create", "ApplicationFeedbackType", new { UrlReferrer = Request.Url, AssociatedType = ViewData["AssociatedType"], HostingEntityName = @Convert.ToString(ViewData["HostingEntity"]), HostingEntityID = @Convert.ToString(ViewData["HostingEntityID"]) }, null) + "');")><i class="glyphicon glyphicon-plus"></i></a>
                                        }                        
                                     </div>
                                                    </center>
                                                </div>
                                            </td>
                                            <td><a href="@Url.Action("RedirectToEntity", "Home", new { EntityName = "ApplicationFeedbackType" })">Application Feedback Type</a></td>
                                            <td>Application Feedback Type</td>
                                            <td>
                                                <div class="input-group">
                                                     @Html.TextBox("SearchStringApplicationFeedbackType", ViewBag.CurrentFilter as string, null, new { @class = "form-control fixsearchbox", @onkeypress = "SearchKeyPress(event,'ApplicationFeedbackType');", @placeholder = "Search" })
												<div class="input-group-btn">
													<a id="ApplicationFeedbackTypeSearch" onclick="HomeSearchClick(event,'ApplicationFeedbackType','@Html.Raw(Url.Action("Index", "ApplicationFeedbackType"))');"
													   data-original-title="List Search"
													   class="btn btn-default btn-default tip-top"
													   style="padding:3px 5px;"><span class="glyphicon glyphicon-search"></span></a>
												</div>
                                                </div>
                                            </td>
                                        </tr>
                    }
					@if (User.CanView("FeedbackPriority"))
                    {
                       <tr>
						<td>
							<div style="width:60px; margin-top:-2px;">
                                                    <center>
                                                        <div class="btn-group">
											<a class="btn btn-default btn-xs" href="@Url.Action("RedirectToEntity", "Home", new { EntityName = "FeedbackPriority" })"><i class="glyphicon glyphicon-eye-open"></i></a>
                                        @if (User.Identity.IsAuthenticated && User != null && User.CanAdd("FeedbackPriority"))
                                        {
												<a class="btn btn-default btn-xs" onclick=@Html.Raw("NavigateToUrl('" + Url.Action("Create", "FeedbackPriority", new { UrlReferrer = Request.Url, AssociatedType = ViewData["AssociatedType"], HostingEntityName = @Convert.ToString(ViewData["HostingEntity"]), HostingEntityID = @Convert.ToString(ViewData["HostingEntityID"]) }, null) + "');")><i class="glyphicon glyphicon-plus"></i></a>
                                        }                        
										 	</div>
                                                    </center>
                                                </div>
                                            </td>
                                            <td><a href="@Url.Action("RedirectToEntity", "Home", new { EntityName = "FeedbackPriority" })">Feedback Priority</a></td>
                                            <td>Feedback Priority</td>
                                            <td>
                                                <div class="input-group">
                                                     @Html.TextBox("SearchStringFeedbackPriority", ViewBag.CurrentFilter as string, null, new { @class = "form-control fixsearchbox", @onkeypress = "SearchKeyPress(event,'FeedbackPriority');", @placeholder = "Search" })
												<div class="input-group-btn">
													<a id="FeedbackPrioritySearch" onclick="HomeSearchClick(event,'FeedbackPriority','@Html.Raw(Url.Action("Index", "FeedbackPriority"))');"
													   data-original-title="List Search"
													   class="btn btn-default btn-default tip-top"
													   style="padding:3px 5px;"><span class="glyphicon glyphicon-search"></span></a>
												</div>
                                                </div>
                                            </td>
                                        </tr>
                    }
                    @if (User.CanView("FeedbackSeverity"))
                    {
                       <tr>
						<td>
							<div style="width:60px; margin-top:-2px;">
                                                    <center>
                                                        <div class="btn-group">
											<a class="btn btn-default btn-xs" href="@Url.Action("RedirectToEntity", "Home", new { EntityName = "FeedbackSeverity" })"><i class="glyphicon glyphicon-eye-open"></i></a>
                                        @if (User.Identity.IsAuthenticated && User != null && User.CanAdd("FeedbackSeverity"))
                                        {
												<a class="btn btn-default btn-xs" onclick=@Html.Raw("NavigateToUrl('" + Url.Action("Create", "FeedbackSeverity", new { UrlReferrer = Request.Url, AssociatedType = ViewData["AssociatedType"], HostingEntityName = @Convert.ToString(ViewData["HostingEntity"]), HostingEntityID = @Convert.ToString(ViewData["HostingEntityID"]) }, null) + "');")><i class="glyphicon glyphicon-plus"></i></a>
												}
                                            	</div>
                                                    </center>
                                                </div>
                                            </td>
                                            <td><a href="@Url.Action("RedirectToEntity", "Home", new { EntityName = "FeedbackSeverity" })">Feedback Severity</a></td>
                                            <td>Feedback Severity</td>
                                            <td>
                                                <div class="input-group">
                                                     @Html.TextBox("SearchStringFeedbackSeverity", ViewBag.CurrentFilter as string, null, new { @class = "form-control fixsearchbox", @onkeypress = "SearchKeyPress(event,'FeedbackSeverity');", @placeholder = "Search" })
												<div class="input-group-btn">
													<a id="FeedbackSeveritySearch" onclick="HomeSearchClick(event,'FeedbackSeverity','@Html.Raw(Url.Action("Index", "FeedbackSeverity"))');"
													   data-original-title="List Search"
													   class="btn btn-default btn-default tip-top"
													   style="padding:3px 5px;"><span class="glyphicon glyphicon-search"></span></a>
												</div>
                                                </div>
                                            </td>
                                        </tr>
                    }
                    @if (User.CanView("FeedbackResource"))
                    {
                       <tr>
						<td>
							<div style="width:60px; margin-top:-2px;">
                                                    <center>
                                                        <div class="btn-group">
											<a class="btn btn-default btn-xs" href="@Url.Action("RedirectToEntity", "Home", new { EntityName = "FeedbackResource" })"><i class="glyphicon glyphicon-eye-open"></i></a>
                                        @if (User.Identity.IsAuthenticated && User != null && User.CanAdd("FeedbackResource"))
                                        {
												<a class="btn btn-default btn-xs" onclick=@Html.Raw("NavigateToUrl('" + Url.Action("Create", "FeedbackResource", new { UrlReferrer = Request.Url, AssociatedType = ViewData["AssociatedType"], HostingEntityName = @Convert.ToString(ViewData["HostingEntity"]), HostingEntityID = @Convert.ToString(ViewData["HostingEntityID"]) }, null) + "');")><i class="glyphicon glyphicon-plus"></i></a>
                                        }                        
                                     	</div>
                                                    </center>
                                                </div>
                                            </td>
                                            <td><a href="@Url.Action("RedirectToEntity", "Home", new { EntityName = "FeedbackResource" })">Feedback Resource</a></td>
                                            <td>Feedback Resource</td>
                                            <td>
                                                <div class="input-group">
                                                     @Html.TextBox("SearchStringFeedbackResource", ViewBag.CurrentFilter as string, null, new { @class = "form-control fixsearchbox", @onkeypress = "SearchKeyPress(event,'FeedbackResource');", @placeholder = "Search" })
												<div class="input-group-btn">
													<a id="FeedbackResourceSearch" onclick="HomeSearchClick(event,'FeedbackResource','@Html.Raw(Url.Action("Index", "FeedbackResource"))');"
													   data-original-title="List Search"
													   class="btn btn-default btn-default tip-top"
													   style="padding:3px 5px;"><span class="glyphicon glyphicon-search"></span></a>
												</div>
                                                </div>
                                            </td>
                                        </tr>
                    }
					@if (HttpContext.Current.User.Identity.IsAuthenticated)
                    {
                        if (User.CanView("ImportConfiguration"))
                        {
                             <tr>
							<td>
							 <div style="width:60px; margin-top:-2px;">
                                                    <center>
                                                        <div class="btn-group">
											<a class="btn btn-default btn-xs" href="@Url.Action("RedirectToEntity", "Home", new { EntityName = "ImportConfiguration" })"><i class="glyphicon glyphicon-eye-open"></i></a>
                                        @if (User.Identity.IsAuthenticated && User != null && User.CanAdd("ImportConfiguration"))
                                        {
												<a class="btn btn-default btn-xs" onclick=@Html.Raw("NavigateToUrl('" + Url.Action("Create", "ImportConfiguration", new { UrlReferrer = Request.Url, AssociatedType = ViewData["AssociatedType"], HostingEntityName = @Convert.ToString(ViewData["HostingEntity"]), HostingEntityID = @Convert.ToString(ViewData["HostingEntityID"]) }, null) + "');")><i class="glyphicon glyphicon-plus"></i></a>
                                        }                        
                                        </div>
                                                    </center>
                                                </div>
                                            </td>
                                            <td><a href="@Url.Action("RedirectToEntity", "Home", new { EntityName = "ImportConfiguration" })">Import Configuration</a></td>
                                            <td>Import Configuration</td>
                                            <td>
                                                <div class="input-group">
                                                     @Html.TextBox("SearchStringImportConfiguration", ViewBag.CurrentFilter as string, null, new { @class = "form-control fixsearchbox", @onkeypress = "SearchKeyPress(event,'ImportConfiguration');", @placeholder = "Search" })
												<div class="input-group-btn">
													<a id="ImportConfigurationSearch" onclick="HomeSearchClick(event,'ImportConfiguration','@Html.Raw(Url.Action("Index", "ImportConfiguration"))');"
													   data-original-title="List Search"
													   class="btn btn-default btn-default tip-top"
													   style="padding:3px 5px;"><span class="glyphicon glyphicon-search"></span></a>
												</div>
                                                </div>
                                            </td>
                                        </tr>
                        }
                    }
                           @if (HttpContext.Current.User.Identity.IsAuthenticated)
                            {
                                if (User.IsAdmin())
                                {
									 <tr>
							<td>
							 <div style="width:60px; margin-top:-2px;">
                                                    <center>
                                                        <div class="btn-group">
											<a class="btn btn-default btn-xs" href="@Url.Action("Index", "Admin")"><i class="glyphicon glyphicon-eye-open"></i></a>
                                        </div>
                                                    </center>
                                                </div>
                                            </td>
                                            <td><a href="@Url.Action("Index", "Admin")">Admin</a></td>
                                            <td>Admin</td>
                                            <td>
                                            </td>
                                        </tr>
                                }
                            }
							 </table>
                            </div>
                        </div>
                    </div>
                </div>
            
       
		<div class="col-lg-3 col-sm-3">
                <div class="panel-group" id="accordion1">
@if (ViewBag.FavoriteItem != null)
{
                    <div class="panel panel-default">
                        <div class="panel-heading clearfix">
                            <h4 class="panel-title">
                                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion1" href="#favitem">
                                    <span class="glyphicon glyphicon-chevron-down" style="margin-left:-15px; !important"></span>
                                    Favorite Items <span class="badge bg-blue">@ViewBag.FavoriteCount</span>
                                </a>
                            </h4>
                        </div>
                        <div id="favitem" class="panel-collapse collapse">
                            <div class="panel-body" style="padding:0px;">
                                <table class="table table-striped table-bordered table-hover table-condensed">
                                    <thead>
                                        @foreach (GeneratorBase.MVC.Models.FavoriteItem fItem in ViewBag.FavoriteItem)
                                        {
                                            <tr>
                                                <td width="90%">
                                                    <a href='/@GeneratorBase.MVC.Models.CommonFunction.Instance.AppURL().ToString()@fItem.LinkAddress' style="color:black">@fItem.Name</a>
                                                </td>
                                                <td width="10%">
                                                    <a href="@Url.Action("FavoriteDelete", "Home", new { id = fItem.Id })"><span class="fam-cross"></span></a>
                                                </td>
                                            </tr>
                                        }
                                    </thead>
                                </table>
                            </div>
                        </div>
                    </div>
                 }
                </div>
        </div>
  </div>
   </div>
}
@if (ViewBag.PageContent != null && ViewBag.PageRoles == null)
{
    @Html.Raw(ViewBag.PageContent)
}
<script type="text/javascript">
    $(function () {
        var chat = $.connection.iServerHub;
        chat.client.broadcastMessage = function (obj) {
            var result = JSON.parse(obj);
            var entityid = result['entityid'];
            var name = result['username'];
            var message = result['entitydisplayname'];
            var datetime = result['datetime'];
            var action = result['action'];
            var entityname = result['entityname'];
            var href = '@Html.ActionLink("_dispName", "Details", "_entityname", new { id = "_id" }, new { target="_blank"})'.replace("_dispName", message).replace("_entityname", entityname).replace("_id", entityid);
            var icon = "<i class=\"glyphicon glyphicon-pencil\"></i> "
            if (action == 'Added' && entityname=="T_School")
            {
                countvalueT_School = countvalueT_School+1;
                yaxiscountT_School = countvalueT_School+100;
            }
			if (action == 'Deleted' && entityname=="T_School")
            {
                countvalueT_School = countvalueT_School-1;
                yaxiscountT_School = countvalueT_School+100;
            }
        };
        $.connection.hub.start().done(function () {
        });
    });
</script>

